{"ast":null,"code":"var _jsxFileName = \"/home/rems/Documents/FAC/L3/S6/JSFS/vendez_les_votre/client/src/components/Market.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport ListItemButton from \"@mui/material/ListItemButton\";\nimport Feedback from \"./Feedback\";\nimport Button from \"@mui/material/Button\";\nimport TextField from \"@mui/material/TextField\";\nimport Box from \"@mui/material/Box\";\nimport Grid from \"@mui/material/Grid\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Divider from \"@mui/material/Divider\";\nimport Backdrop from \"@mui/material/Backdrop\";\nimport Avatar from \"@mui/material/Avatar\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport API from \"../utils/API\";\nimport { styled } from \"@mui/material/styles\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst item_shem = {\n  name: \"\",\n  description: \"\",\n  price: 0,\n  image: \"\"\n};\nconst Input = styled(\"input\")({\n  display: \"none\"\n});\n_c = Input;\nexport default function Market() {\n  _s();\n\n  let navigate = useNavigate();\n  const [myId, set_myId] = useState({});\n  const [money, set_money] = useState(0);\n  const [new_item, set_new_item] = useState(item_shem);\n  const [items, set_items] = useState([]);\n  const [show_change, set_show_change] = useState(false);\n  const [item_change, set_item_change] = useState(item_shem);\n  const [shop, set_shop] = useState({});\n  const [open, setOpen] = useState(false);\n  const [not_money, set_not_money] = useState(false);\n  useEffect(() => {\n    axios.get(`${API.url()}/users/find/${API.getUserId()}`).then(res => {\n      set_myId(res.data);\n    }).catch(e => console.log(e));\n    API.getItemAll().then(res => {\n      set_items(res);\n    });\n  }, []);\n\n  const handleSendMoney = () => {\n    let current_money = parseInt(myId.money);\n    current_money += parseInt(money);\n    if (current_money < 0) current_money = 0;\n    API.setMoney(current_money);\n    set_myId({ ...myId,\n      money: current_money\n    });\n    set_money(0);\n  };\n\n  const handlePurchase = item => {\n    set_shop(item);\n    console.log(item);\n    setOpen(true);\n  };\n\n  const handleTake = () => {\n    let current_money = myId.money;\n\n    if (current_money >= shop.price) {\n      current_money -= shop.price;\n      const newItems = items.map(i => {\n        if (i._id === shop._id) {\n          return { ...i,\n            sell: !i.sell,\n            id_owner: myId._id\n          };\n        }\n\n        return i;\n      });\n      set_items(newItems);\n      set_myId({ ...myId,\n        money: current_money\n      });\n      API.setMoney(current_money);\n      API.buyItem(shop);\n    } else {\n      set_not_money(true);\n      window.setTimeout(() => set_not_money(false), 5000);\n    }\n\n    setOpen(false);\n    set_money(0);\n    set_shop({});\n  };\n\n  const List_items_others = () => {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        width: 1 / 2,\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"A VENDRE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        sx: {\n          textAlign: \"center\"\n        },\n        children: items.filter(item => item.id_owner !== myId._id).map((item, n) => {\n          let description = item.description;\n          let name = item.name + \" | \" + item.price + \" €\";\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(ListItemButton, {\n              onClick: () => handlePurchase(item),\n              children: [/*#__PURE__*/_jsxDEV(Avatar, {\n                src: item.image\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n                sx: {\n                  textAlign: \"center\"\n                },\n                primary: name,\n                secondary: description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 21\n              }, this)]\n            }, name, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 19\n            }, this)]\n          }, name + \"55\", true, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 17\n          }, this);\n        })\n      }, \"liItem\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this);\n  };\n\n  const HandleChange = item => {\n    console.log(item);\n    set_item_change(item);\n    set_show_change(true);\n  };\n\n  const SendChange = () => {\n    API.changeItem(item_change._id, item_change);\n    let itemsChange = items.map(item => {\n      if (item._id === item_change._id) item = item_change;\n      return item;\n    });\n    set_items(itemsChange);\n    set_item_change(item_shem);\n    set_show_change(false);\n  };\n\n  const HandleSell = item => {\n    const newItems = items.map(i => {\n      if (i._id === item._id) {\n        return { ...i,\n          sell: !i.sell\n        };\n      }\n\n      return i;\n    });\n    set_items(newItems);\n    API.setSellItem(item._id, !item.sell);\n  };\n\n  const HandleDelete = item => {\n    API.deleteItem(item._id);\n    let newItem = items.filter(i => i._id !== item._id);\n    set_items(newItem);\n  };\n\n  const Item_Change = () => {\n    return /*#__PURE__*/_jsxDEV(Backdrop, {\n      sx: {\n        color: \"#fff\",\n        zIndex: theme => theme.zIndex.drawer + 1\n      },\n      open: show_change,\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        component: \"form\",\n        sx: {\n          \"& .MuiTextField-root\": {\n            m: 1,\n            width: \"25ch\"\n          }\n        },\n        noValidate: true,\n        autoComplete: \"off\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\" Changement de l'objet \", item_change.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            multiline: true,\n            variant: \"filled\",\n            defaultValue: item_change.name,\n            id: \"outlined-required\",\n            label: \"nom\",\n            onChange: e => set_item_change({ ...item_change,\n              name: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            multiline: true,\n            variant: \"filled\",\n            label: \"description\",\n            onChange: e => set_item_change({ ...item_change,\n              description: e.target.value\n            }),\n            defaultValue: item_change.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            multiline: true,\n            variant: \"filled\",\n            sx: {\n              width: \"12ch\"\n            },\n            label: \"prix\",\n            id: \"standard-number\",\n            type: \"number\",\n            onChange: e => set_item_change({ ...item_change,\n              price: e.target.value\n            }),\n            defaultValue: item_change.price\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => SendChange(),\n            children: \"ENVOI\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            color: \"secondary\",\n            onClick: () => set_show_change(false),\n            children: \"Annuler\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this);\n  };\n\n  const List_items_self = () => {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        width: 1,\n        paddingLeft: 1 / 2,\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"MES OBJETS\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(List, {\n        children: items.filter(item => item.id_owner === myId._id).map((item, n) => {\n          let price = item.price + \" €\";\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(ListItem, {\n              children: [/*#__PURE__*/_jsxDEV(ListItemText, {\n                sx: {\n                  textAlign: \"center\"\n                },\n                primary: item.name,\n                secondary: price\n              }, item.name + \" ok\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Avatar, {\n                src: item.image\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 21\n              }, this)]\n            }, item.name, true, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(ListItem, {\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => HandleChange(item),\n                children: \"Modifier\"\n              }, item.name + \"55\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                color: \"secondary\",\n                onClick: () => HandleDelete(item),\n                children: \"Supprimer\"\n              }, item.name + \"85\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                color: \"info\",\n                onClick: () => HandleSell(item),\n                children: item.sell ? \"Retirer de la vente\" : \"Mettre en vente\"\n              }, item.name + \"7\", false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 21\n              }, this)]\n            }, n, true, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 19\n            }, this)]\n          }, item.name + \"55\", true, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 17\n          }, this);\n        })\n      }, 9999, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 7\n    }, this);\n  };\n\n  const Information = () => {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Bienvenue \", myId.pseudo]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Argent disponible : \", myId.money, \" \\u20AC\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }, this);\n  };\n\n  const HandleAddItem = () => {\n    console.log(new_item);\n    API.createItem(new_item).then(_ => {\n      set_items(oldItem => [...oldItem, new_item]);\n      set_new_item(item_shem);\n    }).catch(_ => console.log(\"erreur creation d'item\"));\n  };\n\n  const Logout = () => {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        color: \"secondary\",\n        onClick: () => {\n          API.logout();\n          navigate(\"/login\");\n        },\n        children: \"DECONNEXION\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this);\n  };\n\n  const AddMoney = () => {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Ajout d'argent\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          type: \"number\",\n          onChange: e => set_money(e.target.value),\n          value: money,\n          label: \"Ajout d'argent\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => handleSendMoney(),\n          children: \"ENVOI\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 7\n    }, this);\n  };\n\n  const AddItem = () => {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        textAlign: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \" Ajout d'un nouvel item\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          type: \"text\",\n          onChange: e => set_new_item({ ...new_item,\n            name: e.target.value\n          }),\n          value: new_item.name,\n          label: \"nom\",\n          multiline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          type: \"text\",\n          onChange: e => set_new_item({ ...new_item,\n            description: e.target.value\n          }),\n          value: new_item.description,\n          label: \"description\",\n          multiline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          sx: {\n            width: \"15ch\"\n          },\n          id: \"standard-number\",\n          type: \"number\",\n          onChange: e => set_new_item({ ...new_item,\n            price: e.target.value\n          }),\n          value: new_item.price,\n          InputLabelProps: {\n            shrink: true\n          },\n          label: \"prix\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"contained-button-file\",\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            accept: \"image/*\",\n            id: \"contained-button-file\",\n            multiple: true,\n            type: \"file\",\n            onChange: e => set_new_item({ ...new_item,\n              image: e.target.files.name\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            component: \"span\",\n            children: \"Upload\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => HandleAddItem(),\n          children: \"ENVOI\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 7\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [Information(), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      children: [/*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Backdrop, {\n          sx: {\n            color: \"#fff\"\n          },\n          open: open,\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            children: /*#__PURE__*/_jsxDEV(\"h1\", {\n              children: [\"Acheter un/une \", shop.name, \" pour \", shop.price, \" \\u20AC ?\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              size: \"large\",\n              onClick: () => handleTake(),\n              children: \"OUI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              size: \"large\",\n              color: \"secondary\",\n              onClick: () => setOpen(false),\n              children: \"NON\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 429,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), List_items_others(), Feedback({\n          ok: false,\n          text: \"Argent insuffisant !\",\n          open: not_money\n        })]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [Item_Change(), List_items_self()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), AddItem(), AddMoney(), \" \", Logout()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 415,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Market, \"pILbLWUktvWKnZ8kE41XJVxr67Q=\", false, function () {\n  return [useNavigate];\n});\n\n_c2 = Market;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Input\");\n$RefreshReg$(_c2, \"Market\");","map":{"version":3,"sources":["/home/rems/Documents/FAC/L3/S6/JSFS/vendez_les_votre/client/src/components/Market.js"],"names":["React","useState","useEffect","ListItemButton","Feedback","Button","TextField","Box","Grid","List","ListItem","ListItemText","Divider","Backdrop","Avatar","useNavigate","axios","API","styled","item_shem","name","description","price","image","Input","display","Market","navigate","myId","set_myId","money","set_money","new_item","set_new_item","items","set_items","show_change","set_show_change","item_change","set_item_change","shop","set_shop","open","setOpen","not_money","set_not_money","get","url","getUserId","then","res","data","catch","e","console","log","getItemAll","handleSendMoney","current_money","parseInt","setMoney","handlePurchase","item","handleTake","newItems","map","i","_id","sell","id_owner","buyItem","window","setTimeout","List_items_others","width","textAlign","filter","n","HandleChange","SendChange","changeItem","itemsChange","HandleSell","setSellItem","HandleDelete","deleteItem","newItem","Item_Change","color","zIndex","theme","drawer","m","target","value","List_items_self","paddingLeft","Information","pseudo","HandleAddItem","createItem","_","oldItem","Logout","logout","AddMoney","AddItem","shrink","files","ok","text"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ListItemButton from \"@mui/material/ListItemButton\";\nimport Feedback from \"./Feedback\";\nimport Button from \"@mui/material/Button\";\nimport TextField from \"@mui/material/TextField\";\nimport Box from \"@mui/material/Box\";\nimport Grid from \"@mui/material/Grid\";\nimport List from \"@mui/material/List\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport Divider from \"@mui/material/Divider\";\nimport Backdrop from \"@mui/material/Backdrop\";\nimport Avatar from \"@mui/material/Avatar\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport API from \"../utils/API\";\nimport { styled } from \"@mui/material/styles\";\n\nconst item_shem = {\n  name: \"\",\n  description: \"\",\n  price: 0,\n  image: \"\",\n};\n\nconst Input = styled(\"input\")({\n  display: \"none\",\n});\n\nexport default function Market() {\n  let navigate = useNavigate();\n  const [myId, set_myId] = useState({});\n  const [money, set_money] = useState(0);\n  const [new_item, set_new_item] = useState(item_shem);\n  const [items, set_items] = useState([]);\n  const [show_change, set_show_change] = useState(false);\n  const [item_change, set_item_change] = useState(item_shem);\n  const [shop, set_shop] = useState({});\n  const [open, setOpen] = useState(false);\n  const [not_money, set_not_money] = useState(false);\n\n  useEffect(() => {\n    axios\n      .get(`${API.url()}/users/find/${API.getUserId()}`)\n      .then((res) => {\n        set_myId(res.data);\n      })\n      .catch((e) => console.log(e));\n    API.getItemAll().then((res) => {\n      set_items(res);\n    });\n  }, []);\n\n  const handleSendMoney = () => {\n    let current_money = parseInt(myId.money);\n    current_money += parseInt(money);\n    if (current_money < 0) current_money = 0;\n    API.setMoney(current_money);\n    set_myId({\n      ...myId,\n      money: current_money,\n    });\n\n    set_money(0);\n  };\n\n  const handlePurchase = (item) => {\n    set_shop(item);\n    console.log(item);\n    setOpen(true);\n  };\n\n  const handleTake = () => {\n    let current_money = myId.money;\n\n    if (current_money >= shop.price) {\n      current_money -= shop.price;\n      const newItems = items.map((i) => {\n        if (i._id === shop._id) {\n          return {\n            ...i,\n            sell: !i.sell,\n            id_owner: myId._id,\n          };\n        }\n        return i;\n      });\n      set_items(newItems);\n      set_myId({\n        ...myId,\n        money: current_money,\n      });\n      API.setMoney(current_money);\n      API.buyItem(shop);\n    } else {\n      set_not_money(true);\n      window.setTimeout(() => set_not_money(false), 5000);\n    }\n    setOpen(false);\n    set_money(0);\n    set_shop({});\n  };\n\n  const List_items_others = () => {\n    return (\n      <Box sx={{ width: 1 / 2, textAlign: \"center\" }}>\n        <h2>A VENDRE</h2>\n        <List key={\"liItem\"} sx={{ textAlign: \"center\" }}>\n          {items\n            .filter((item) => item.id_owner !== myId._id)\n            .map((item, n) => {\n              let description = item.description;\n              let name = item.name + \" | \" + item.price + \" €\";\n              return (\n                <div key={name + \"55\"}>\n                  <ListItemButton\n                    key={name}\n                    onClick={() => handlePurchase(item)}\n                  >\n                    <Avatar src={item.image} />\n                    <ListItemText\n                      sx={{ textAlign: \"center\" }}\n                      primary={name}\n                      secondary={description}\n                    />\n                  </ListItemButton>\n                  <Divider />\n                </div>\n              );\n            })}\n        </List>\n      </Box>\n    );\n  };\n\n  const HandleChange = (item) => {\n    console.log(item);\n    set_item_change(item);\n    set_show_change(true);\n  };\n\n  const SendChange = () => {\n    API.changeItem(item_change._id, item_change);\n    let itemsChange = items.map((item) => {\n      if (item._id === item_change._id) item = item_change;\n      return item;\n    });\n    set_items(itemsChange);\n    set_item_change(item_shem);\n    set_show_change(false);\n  };\n\n  const HandleSell = (item) => {\n    const newItems = items.map((i) => {\n      if (i._id === item._id) {\n        return {\n          ...i,\n          sell: !i.sell,\n        };\n      }\n      return i;\n    });\n    set_items(newItems);\n    API.setSellItem(item._id, !item.sell);\n  };\n\n  const HandleDelete = (item) => {\n    API.deleteItem(item._id);\n    let newItem = items.filter((i) => i._id !== item._id);\n    set_items(newItem);\n  };\n\n  const Item_Change = () => {\n    return (\n      <Backdrop\n        sx={{ color: \"#fff\", zIndex: (theme) => theme.zIndex.drawer + 1 }}\n        open={show_change}\n      >\n        <Box\n          component=\"form\"\n          sx={{\n            \"& .MuiTextField-root\": { m: 1, width: \"25ch\" },\n          }}\n          noValidate\n          autoComplete=\"off\"\n        >\n          <h2> Changement de l'objet {item_change.name}</h2>\n          <div>\n            <TextField\n              multiline\n              variant=\"filled\"\n              defaultValue={item_change.name}\n              id=\"outlined-required\"\n              label=\"nom\"\n              onChange={(e) =>\n                set_item_change({\n                  ...item_change,\n                  name: e.target.value,\n                })\n              }\n            ></TextField>\n            <TextField\n              multiline\n              variant=\"filled\"\n              label=\"description\"\n              onChange={(e) =>\n                set_item_change({\n                  ...item_change,\n                  description: e.target.value,\n                })\n              }\n              defaultValue={item_change.description}\n            ></TextField>\n            <TextField\n              multiline\n              variant=\"filled\"\n              sx={{ width: \"12ch\" }}\n              label=\"prix\"\n              id=\"standard-number\"\n              type=\"number\"\n              onChange={(e) =>\n                set_item_change({\n                  ...item_change,\n                  price: e.target.value,\n                })\n              }\n              defaultValue={item_change.price}\n            ></TextField>\n          </div>\n          <Box>\n            <Button onClick={() => SendChange()}>ENVOI</Button>\n            <Button color=\"secondary\" onClick={() => set_show_change(false)}>\n              Annuler\n            </Button>\n          </Box>\n        </Box>\n      </Backdrop>\n    );\n  };\n\n  const List_items_self = () => {\n    return (\n      <Box sx={{ width: 1, paddingLeft: 1 / 2, textAlign: \"center\" }}>\n        <h2>MES OBJETS</h2>\n        <List key={9999}>\n          {items\n            .filter((item) => item.id_owner === myId._id)\n            .map((item, n) => {\n              let price = item.price + \" €\";\n              return (\n                <div key={item.name + \"55\"}>\n                  <ListItem key={item.name}>\n                    <ListItemText\n                      sx={{ textAlign: \"center\" }}\n                      key={item.name + \" ok\"}\n                      primary={item.name}\n                      secondary={price}\n                    />\n                    <Avatar src={item.image} />\n                  </ListItem>\n                  <ListItem key={n}>\n                    <Button\n                      key={item.name + \"55\"}\n                      onClick={() => HandleChange(item)}\n                    >\n                      Modifier\n                    </Button>\n                    <Button\n                      key={item.name + \"85\"}\n                      color=\"secondary\"\n                      onClick={() => HandleDelete(item)}\n                    >\n                      Supprimer\n                    </Button>\n                    <Button\n                      key={item.name + \"7\"}\n                      color=\"info\"\n                      onClick={() => HandleSell(item)}\n                    >\n                      {item.sell ? \"Retirer de la vente\" : \"Mettre en vente\"}\n                    </Button>\n                  </ListItem>\n                  <Divider />\n                </div>\n              );\n            })}\n        </List>\n      </Box>\n    );\n  };\n\n  const Information = () => {\n    return (\n      <Box sx={{ textAlign: \"center\" }}>\n        <h1>Bienvenue {myId.pseudo}</h1>\n        <h2>Argent disponible : {myId.money} €</h2>\n      </Box>\n    );\n  };\n\n  const HandleAddItem = () => {\n    console.log(new_item);\n    API.createItem(new_item)\n      .then((_) => {\n        set_items((oldItem) => [...oldItem, new_item]);\n        set_new_item(item_shem);\n      })\n      .catch((_) => console.log(\"erreur creation d'item\"));\n  };\n  const Logout = () => {\n    return (\n      <Box>\n        <Button\n          color=\"secondary\"\n          onClick={() => {\n            API.logout();\n            navigate(\"/login\");\n          }}\n        >\n          DECONNEXION\n        </Button>\n      </Box>\n    );\n  };\n\n  const AddMoney = () => {\n    return (\n      <Box sx={{ textAlign: \"center\" }}>\n        <Box>\n          <h2>Ajout d'argent</h2>\n          <TextField\n            type=\"number\"\n            onChange={(e) => set_money(e.target.value)}\n            value={money}\n            label=\"Ajout d'argent\"\n          ></TextField>\n        </Box>\n        <Box>\n          <Button onClick={() => handleSendMoney()}>ENVOI</Button>\n        </Box>\n      </Box>\n    );\n  };\n\n  const AddItem = () => {\n    return (\n      <Box sx={{ textAlign: \"center\" }}>\n        <h2> Ajout d'un nouvel item</h2>\n        <div>\n          <TextField\n            type=\"text\"\n            onChange={(e) =>\n              set_new_item({\n                ...new_item,\n                name: e.target.value,\n              })\n            }\n            value={new_item.name}\n            label=\"nom\"\n            multiline\n          ></TextField>\n          <TextField\n            type=\"text\"\n            onChange={(e) =>\n              set_new_item({\n                ...new_item,\n                description: e.target.value,\n              })\n            }\n            value={new_item.description}\n            label=\"description\"\n            multiline\n          ></TextField>\n          <TextField\n            sx={{ width: \"15ch\" }}\n            id=\"standard-number\"\n            type=\"number\"\n            onChange={(e) =>\n              set_new_item({\n                ...new_item,\n                price: e.target.value,\n              })\n            }\n            value={new_item.price}\n            InputLabelProps={{\n              shrink: true,\n            }}\n            label=\"prix\"\n          ></TextField>\n          <label htmlFor=\"contained-button-file\">\n            <Input\n              accept=\"image/*\"\n              id=\"contained-button-file\"\n              multiple\n              type=\"file\"\n              onChange={(e) =>\n                set_new_item({\n                  ...new_item,\n                  image: e.target.files.name,\n                })\n              }\n            />\n            <Button variant=\"contained\" component=\"span\">\n              Upload\n            </Button>\n          </label>\n        </div>\n        <Box>\n          <Button onClick={() => HandleAddItem()}>ENVOI</Button>\n        </Box>\n      </Box>\n    );\n  };\n  return (\n    <div>\n      {Information()}\n      <Grid container>\n        <>\n          <Backdrop sx={{ color: \"#fff\" }} open={open}>\n            <Box>\n              <h1>\n                Acheter un/une {shop.name} pour {shop.price} € ?\n              </h1>\n            </Box>\n            <Box>\n              <Button size=\"large\" onClick={() => handleTake()}>\n                OUI\n              </Button>\n              <Button\n                size=\"large\"\n                color=\"secondary\"\n                onClick={() => setOpen(false)}\n              >\n                NON\n              </Button>\n            </Box>\n          </Backdrop>\n          {List_items_others()}\n          {Feedback({\n            ok: false,\n            text: \"Argent insuffisant !\",\n            open: not_money,\n          })}\n        </>\n        <div>\n          {Item_Change()}\n          {List_items_self()}\n        </div>\n      </Grid>\n      {AddItem()}\n      {AddMoney()} {Logout()}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}